{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect } from 'react';\nimport { useSocket } from './useSocket';\nexport const useSchools = () => {\n  _s();\n  const [schools, setSchools] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const {\n    socket\n  } = useSocket();\n  const API_BASE_URL = 'http://localhost:3001/api';\n  const fetchSchools = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      const response = await fetch(`${API_BASE_URL}/schools`);\n      const result = await response.json();\n      if (result.success) {\n        setSchools(result.data);\n      } else {\n        throw new Error(result.message || 'Failed to fetch schools');\n      }\n    } catch (error) {\n      console.error('Error fetching schools:', error);\n      setError('Failed to load schools gallery. Please try again later.');\n      setSchools([]);\n    } finally {\n      setLoading(false);\n    }\n  };\n  useEffect(() => {\n    fetchSchools();\n\n    // Set up real-time listeners\n    if (socket) {\n      const handleNewSchool = newSchool => {\n        console.log('ðŸ« New school received:', newSchool);\n        setSchools(prev => [...prev, newSchool]);\n      };\n      const handleUpdatedSchool = updatedSchool => {\n        console.log('ðŸ« School updated:', updatedSchool);\n        setSchools(prev => prev.map(school => school._id === updatedSchool._id ? updatedSchool : school));\n      };\n      const handleDeletedSchool = data => {\n        console.log('ðŸ« School deleted:', data.id);\n        setSchools(prev => prev.filter(school => school._id !== data.id));\n      };\n      socket.on('school_created', handleNewSchool);\n      socket.on('school_updated', handleUpdatedSchool);\n      socket.on('school_deleted', handleDeletedSchool);\n      return () => {\n        socket.off('school_created', handleNewSchool);\n        socket.off('school_updated', handleUpdatedSchool);\n        socket.off('school_deleted', handleDeletedSchool);\n      };\n    }\n  }, [socket]);\n  return {\n    schools,\n    loading,\n    error,\n    fetchSchools\n  };\n};\n_s(useSchools, \"hXncjTfT9RMvSTVkoSDCYjhG86Q=\", false, function () {\n  return [useSocket];\n});","map":{"version":3,"names":["useState","useEffect","useSocket","useSchools","_s","schools","setSchools","loading","setLoading","error","setError","socket","API_BASE_URL","fetchSchools","response","fetch","result","json","success","data","Error","message","console","handleNewSchool","newSchool","log","prev","handleUpdatedSchool","updatedSchool","map","school","_id","handleDeletedSchool","id","filter","on","off"],"sources":["C:/jbmmsi/client/src/hooks/useSchools.js"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { useSocket } from './useSocket';\r\n\r\nexport const useSchools = () => {\r\n  const [schools, setSchools] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const { socket } = useSocket();\r\n\r\n  const API_BASE_URL = 'http://localhost:3001/api';\r\n\r\n  const fetchSchools = async () => {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n      const response = await fetch(`${API_BASE_URL}/schools`);\r\n      const result = await response.json();\r\n      \r\n      if (result.success) {\r\n        setSchools(result.data);\r\n      } else {\r\n        throw new Error(result.message || 'Failed to fetch schools');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching schools:', error);\r\n      setError('Failed to load schools gallery. Please try again later.');\r\n      setSchools([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchSchools();\r\n\r\n    // Set up real-time listeners\r\n    if (socket) {\r\n      const handleNewSchool = (newSchool) => {\r\n        console.log('ðŸ« New school received:', newSchool);\r\n        setSchools(prev => [...prev, newSchool]);\r\n      };\r\n\r\n      const handleUpdatedSchool = (updatedSchool) => {\r\n        console.log('ðŸ« School updated:', updatedSchool);\r\n        setSchools(prev => \r\n          prev.map(school => \r\n            school._id === updatedSchool._id ? updatedSchool : school\r\n          )\r\n        );\r\n      };\r\n\r\n      const handleDeletedSchool = (data) => {\r\n        console.log('ðŸ« School deleted:', data.id);\r\n        setSchools(prev => \r\n          prev.filter(school => school._id !== data.id)\r\n        );\r\n      };\r\n\r\n      socket.on('school_created', handleNewSchool);\r\n      socket.on('school_updated', handleUpdatedSchool);\r\n      socket.on('school_deleted', handleDeletedSchool);\r\n\r\n      return () => {\r\n        socket.off('school_created', handleNewSchool);\r\n        socket.off('school_updated', handleUpdatedSchool);\r\n        socket.off('school_deleted', handleDeletedSchool);\r\n      };\r\n    }\r\n  }, [socket]);\r\n\r\n  return {\r\n    schools,\r\n    loading,\r\n    error,\r\n    fetchSchools\r\n  };\r\n};"],"mappings":";AAAA,SAASA,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAC3C,SAASC,SAAS,QAAQ,aAAa;AAEvC,OAAO,MAAMC,UAAU,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC9B,MAAM,CAACC,OAAO,EAAEC,UAAU,CAAC,GAAGN,QAAQ,CAAC,EAAE,CAAC;EAC1C,MAAM,CAACO,OAAO,EAAEC,UAAU,CAAC,GAAGR,QAAQ,CAAC,IAAI,CAAC;EAC5C,MAAM,CAACS,KAAK,EAAEC,QAAQ,CAAC,GAAGV,QAAQ,CAAC,IAAI,CAAC;EACxC,MAAM;IAAEW;EAAO,CAAC,GAAGT,SAAS,CAAC,CAAC;EAE9B,MAAMU,YAAY,GAAG,2BAA2B;EAEhD,MAAMC,YAAY,GAAG,MAAAA,CAAA,KAAY;IAC/B,IAAI;MACFL,UAAU,CAAC,IAAI,CAAC;MAChBE,QAAQ,CAAC,IAAI,CAAC;MACd,MAAMI,QAAQ,GAAG,MAAMC,KAAK,CAAC,GAAGH,YAAY,UAAU,CAAC;MACvD,MAAMI,MAAM,GAAG,MAAMF,QAAQ,CAACG,IAAI,CAAC,CAAC;MAEpC,IAAID,MAAM,CAACE,OAAO,EAAE;QAClBZ,UAAU,CAACU,MAAM,CAACG,IAAI,CAAC;MACzB,CAAC,MAAM;QACL,MAAM,IAAIC,KAAK,CAACJ,MAAM,CAACK,OAAO,IAAI,yBAAyB,CAAC;MAC9D;IACF,CAAC,CAAC,OAAOZ,KAAK,EAAE;MACda,OAAO,CAACb,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;MAC/CC,QAAQ,CAAC,yDAAyD,CAAC;MACnEJ,UAAU,CAAC,EAAE,CAAC;IAChB,CAAC,SAAS;MACRE,UAAU,CAAC,KAAK,CAAC;IACnB;EACF,CAAC;EAEDP,SAAS,CAAC,MAAM;IACdY,YAAY,CAAC,CAAC;;IAEd;IACA,IAAIF,MAAM,EAAE;MACV,MAAMY,eAAe,GAAIC,SAAS,IAAK;QACrCF,OAAO,CAACG,GAAG,CAAC,yBAAyB,EAAED,SAAS,CAAC;QACjDlB,UAAU,CAACoB,IAAI,IAAI,CAAC,GAAGA,IAAI,EAAEF,SAAS,CAAC,CAAC;MAC1C,CAAC;MAED,MAAMG,mBAAmB,GAAIC,aAAa,IAAK;QAC7CN,OAAO,CAACG,GAAG,CAAC,oBAAoB,EAAEG,aAAa,CAAC;QAChDtB,UAAU,CAACoB,IAAI,IACbA,IAAI,CAACG,GAAG,CAACC,MAAM,IACbA,MAAM,CAACC,GAAG,KAAKH,aAAa,CAACG,GAAG,GAAGH,aAAa,GAAGE,MACrD,CACF,CAAC;MACH,CAAC;MAED,MAAME,mBAAmB,GAAIb,IAAI,IAAK;QACpCG,OAAO,CAACG,GAAG,CAAC,oBAAoB,EAAEN,IAAI,CAACc,EAAE,CAAC;QAC1C3B,UAAU,CAACoB,IAAI,IACbA,IAAI,CAACQ,MAAM,CAACJ,MAAM,IAAIA,MAAM,CAACC,GAAG,KAAKZ,IAAI,CAACc,EAAE,CAC9C,CAAC;MACH,CAAC;MAEDtB,MAAM,CAACwB,EAAE,CAAC,gBAAgB,EAAEZ,eAAe,CAAC;MAC5CZ,MAAM,CAACwB,EAAE,CAAC,gBAAgB,EAAER,mBAAmB,CAAC;MAChDhB,MAAM,CAACwB,EAAE,CAAC,gBAAgB,EAAEH,mBAAmB,CAAC;MAEhD,OAAO,MAAM;QACXrB,MAAM,CAACyB,GAAG,CAAC,gBAAgB,EAAEb,eAAe,CAAC;QAC7CZ,MAAM,CAACyB,GAAG,CAAC,gBAAgB,EAAET,mBAAmB,CAAC;QACjDhB,MAAM,CAACyB,GAAG,CAAC,gBAAgB,EAAEJ,mBAAmB,CAAC;MACnD,CAAC;IACH;EACF,CAAC,EAAE,CAACrB,MAAM,CAAC,CAAC;EAEZ,OAAO;IACLN,OAAO;IACPE,OAAO;IACPE,KAAK;IACLI;EACF,CAAC;AACH,CAAC;AAACT,EAAA,CAzEWD,UAAU;EAAA,QAIFD,SAAS;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}